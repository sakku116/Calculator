# variable '#: set name value'
#:set space 7

# change and set the default button style
<Button>
    color: (1,1,1,1)
    font_size: 20

# Create modified widget with new name
# (RoundedButton as Button)
<NumButton@Button>
    background_color: (0,0,0,0)
    background_normal: ''
    color: (0,0,0,.8)
    border_radius: 10
    canvas.before:
        Color:
            rgba: (141/255, 255/255, 252/255, .6) if self.state=='normal' else (0,0,0,.6) # visual feedback
            # (dalam canvas.before tidak bisa menampilkan visual feedback,
            # karena visual feedback secara default merupakan bagian elemen dari background color
            # , dan sebab background color diberi 0 alpha / transparan, maka secara default
            # fedback juga tidak terlihat)
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [self.border_radius]
        Color:
            rgba: (0,0,0,.14)
        Line:
            rounded_rectangle: self.pos[0], self.pos[1], self.size[0], self.size[1], 10
            width: 1

<TopButton@Button>
    background_color: (0,0,0,0)
    background_normal: ''
    color: (228/255, 31/255, 5/255, .8)
    canvas.before:
        Color:
            rgba: (255/255, 241/255, 152/255,1) if self.state=='normal' else (0,0,0,.6) # visual feedback
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [10]
        Color:
            rgba: (0,0,0,.14)
        Line:
            rounded_rectangle: self.pos[0], self.pos[1], self.size[0], self.size[1], 10
            width: 1


<SideButton@Button>
    background_color: (0,0,0,0)
    background_normal: ''
    color: (228/255, 31/255, 5/255, .8)
    canvas.before:
        Color:
            rgba: (255/255, 241/255, 152/255,1) if self.state=='normal' else (0,0,0,.6) # visual feedback
        RoundedRectangle:
            size: self.size
            pos: self.pos
            radius: [10]
        Color:
            rgba: (0,0,0,.14)
        Line:
            rounded_rectangle: self.pos[0], self.pos[1], self.size[0], self.size[1], 10
            width: 1

########## MAIN LAYOUT ##########
<CalcLayout>
    canvas.before:
        Color:
            rgba: 1,1,1,1
        Rectangle:
            pos: self.pos
            size: self.size

    ### MAIN LAYOUT ###
    GridLayout:
        cols: 1
        size: root.width, root.height
        spacing: space
        padding: 8

        ### OUTPUT LABEL ###
        BoxLayout:
            orientation: 'vertical'

            Label: # history output label
                id: output_history
                multiline: True
                color: (0,0,0,.3)
                size_hint: (1,.5)
                text_size: self.size # Harus ditambahkan untuk mengatur posisi di LABEL
                font_size: 30
                halign: 'right'
                valign: 'top'
                canvas.before:
                    Color:
                        rgba: (1,1,1,1)
                    Rectangle:
                        size: self.size
                        pos: self.pos

            Label: # output label
                id: output_label
                multiline: True
                color: (0,0,0,.85)
                size_hint: (1, 1)
                text_size: self.size # Harus ditambahkan untuk mengatur posisi di LABEL
                font_size: 40
                halign: 'right'
                valign: 'bottom'
                canvas.before:
                    Color:
                        rgba: (1,1,1,1)
                    Rectangle:
                        size: self.size
                        pos: self.pos

        ### TOP SIDE BUTTON (clear and some operators) ###
        BoxLayout:
            orientation: 'vertical'
            size_hint: (1, .4)
            spacing: space

            # DELETE, CLEAR, BRACKETS BUTTON
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: .089
                spacing: space

                BoxLayout:
                    orientation: 'horizontal'
                    spacing: space

                    TopButton: # reference to <TopButton@Button>
                        text: 'C'
                        font_name: 'JetBrainsMono-VariableFont_wght.ttf'
                        font_size: 15
                        on_press: root.clear()
                    TopButton:
                        text: '←'
                        font_name: 'JetBrainsMono-VariableFont_wght.ttf'
                        font_size: 17
                        on_press: root.delete()

                    TopButton:
                        text: '('
                        on_press: root.button_press('(')

                BoxLayout:
                    size_hint: .375,1

                    TopButton:
                        text: ')'
                        size_hint_x: 1.125
                        on_press: root.button_press(')')

            # TOP SIDE OPERATORS
            BoxLayout:
                orientation: 'horizontal'
                size_hint: (1,.1)
                spacing: space

                BoxLayout:
                    orientation: 'horizontal'
                    spacing: space

                    TopButton:
                        text: '√'
                        on_press: root.button_press('√')
                    TopButton:
                        text: '%'
                        on_press: root.button_press('%')
                    TopButton:
                        markup: True
                        text: 'X[size=23][sup]y[/sup][/size]'
                        font_size: 17
                        on_press: root.button_press('^')

                BoxLayout:
                    orientation: 'horizontal'
                    size_hint: .375,1

                    TopButton:
                        text: '÷'
                        on_press: root.button_press('÷')

        ### NUMBER AND SIDE OPERATORS BUTTON ###
        BoxLayout:
            orientation: 'horizontal'
            spacing: space

            ### NUMBER BUTTON ###
            GridLayout:
                cols: 3
                spacing: space

                NumButton: # reference to <NumButton@Button>
                    text: '1'
                    on_press: root.button_press(1)
                NumButton:
                    text: '2'
                    on_press: root.button_press(2)
                NumButton:
                    text: '3'
                    on_press: root.button_press(3)
                NumButton:
                    text: '4'
                    on_press: root.button_press(4)
                NumButton:
                    text: '5'
                    on_press: root.button_press(5)
                NumButton:
                    text: '6'
                    on_press: root.button_press(6)
                NumButton:
                    text: '7'
                    on_press: root.button_press(7)
                NumButton:
                    text: '8'
                    on_press: root.button_press(8)
                NumButton:
                    text: '9'
                    on_press: root.button_press(9)
                NumButton:
                    text: '.'
                    on_press: root.button_press('.')
                NumButton:
                    text: '0'
                    on_press: root.button_press(0)
                NumButton:
                    text: '-'
                    font_size: 23
                    on_press: root.button_press('-')

            ### SIDE OPERATORS BUTTON ###
            GridLayout:
                cols:1
                size_hint: (.375,1)
                spacing: space

                BoxLayout:
                    orientation: 'vertical'
                    spacing: space

                    SideButton: # refrence to <SideButton@Button>
                        text: '×'
                        on_press: root.button_press('×')
                    SideButton:
                        text: '+'
                        on_press: root.button_press('+')

                BoxLayout:
                    orientation: 'vertical'

                    SideButton:
                        text: '='
                        color: (0,0,0,.8)
                        on_press: root.equals_button()
                        canvas.before:
                            Color:
                                rgba: (234/255, 191/255, 73/255,.6) if self.state=='normal' else (0,0,0,.6) # visual feedback
                            RoundedRectangle:
                                size: self.size
                                pos: self.pos
                                radius: [10]
                            
